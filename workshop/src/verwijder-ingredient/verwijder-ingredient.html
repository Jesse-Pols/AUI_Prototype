<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/app-storage/app-localstorage/app-localstorage-document.html">

<link rel="import" href="../../bower_components/paper-input-2.x/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">

<link rel="import" href="../../bower_components/s-table/s-table-lite.html">
<link rel="import" href="../../bower_components/s-table/s-tbody.html">
<link rel="import" href="../../bower_components/s-table/s-tr.html">


<dom-module id="verwijder-ingredient">
  <template>
    <style>
      :host {
        display: block;
      }

      td, th {
        padding: 8px;
        box-sizing: border-box;
        white-space: nowrap;
      }
      td:nth-of-type(1),
      th:nth-of-type(1) {
        background-color: rgba(0, 67, 255, 0.08);
      }
      tr.iron-selected td {
        background-color: rgba(0, 0, 0, 0.1);
      }
      tr:hover td {
        background-color: rgba(0, 0, 0, 0.08);
      }
      tr td.iron-selected:not(:nth-of-type(1)) {
        background-color: rgba(0, 67, 255, 0.08);
      }

      #menuButton {
        position: fixed;
        display: block;
        background-color: #70a6ff;
        color: #fff;
        padding: 25px;
        margin-top: 25px;
        width: 500px;
        text-align: center;
      }

      paper-button.btnTerug {
        position: fixed;
        margin-left:  250px;
        margin-top: 300px;
        background-color: #70a6ff;
        color: #fff;
      }

      #menu {
        display: block;
        position: fixed;
        top: 40%;
        left: 50%;
        transform: translate(-50%, -50%);

        padding: 30px 50px;
        border: 1px solid #d3e4ff;

        height: 400px;
        width: 300px;
      }

      #ingredientenLijst{
        position: fixed;
        border: 1px solid #d3e4ff;
        width: 300px;
      }

      #verwijderDialog{
           top: 40%;
          left: 65%;

          height: 115px;
          width: 200px;
          position: absolute;

          background: #adcbfd8f;
          border: 1px solid #70a6ff;
      }

      #verwijderButton{
          font-family: Arial, Helvetica, sans-serif;
          color: rgb(255, 0, 0);
          text-align: center;
          width: 100px;
      }

      .closeDialogClass{
          font-size: 14px;
          background-color: #70a6ff;
          color: #fff;
      }

    </style>

    <app-localstorage-document key="localGerechten" data="{{localGerechten}}">
    <app-localstorage-document key="localIngredienten" data="{{localIngredienten}}">

    <div id="menu">
        <h1>Verwijder ingredient</h1>
        <div id="ingredientenLijst">
            <table is="s-table-lite" fixed-column>
                <thead>
                    <tr>
                        <th>Nummer</th>
                        <th>Ingredient</th>
                        <th>Verwijder</th>
                    </tr>
                </thead>
                <tbody is="s-tbody">
                    <template is="dom-repeat" items="{{localIngredienten}}" as="ingredient">
                        <tr is="s-tr" multi>
                        <td>{{ingredient.id}}</td>
                        <td>{{ingredient.naam}}</td>
                        <td><paper-button id="verwijderButton" on-click="verwijder">X</paper-button></td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
        <div>
            <a href="eigenaar_home.html"><paper-button class="btnTerug">Terug</paper-button></a>
        </div>

    </div>


    <div id="verwijderDialog" hidden="{{hideDialog}}">
        <br>
        <paper-button class="closeDialogClass" on-click="closeDialog">Verwijderen</paper-button>
        <br>
        <br>
        <br>
        <paper-button class="closeDialogClass" on-click="closeDialog">Annuleren</paper-button>
    </div>

  </template>

  <script>
    /**
     * @customElement
     * @polymer
     */
    class VerwijderIngredient extends Polymer.Element {
      static get is() { return 'verwijder-ingredient'; }
      static get properties() {
        return {
          hideDialog:{
              type: Boolean,
              value: true
          }
        };
      }
      verwijder(id){
        console.log(id);

        // check all items in path
        for (var i = 0; i < id.path.length; i++){

          // check if item is table row, containing all data we need
          if (id.path[i] instanceof HTMLTableRowElement){

            // var item is the name of the item we want to remove from ingredients
            var item = id.path[i].cells[0].textContent;
            var ingredients = JSON.parse(localStorage.getItem('localIngredienten'));

            // Every ingredient is checked by name
            for (var j = 0; j < ingredients.length; j++){
              if (ingredients[j].id == item){

                // ingredient is spliced from array, and pushed to properties
                ingredients.splice(j, 1);
                localStorage.setItem('localIngredienten', JSON.stringify(ingredients));
                location.reload();
                //this.setAttribute('ingredienten', JSON.stringify(ingredients));

              }
            }
          }
        }
      }
        /* These functions no longer work
        verwijder(id){
            console.log(id);
            console.log("kaas");
            console.log(this.hideDialog);
            this.hideDialog = false;
        }
        closeDialog(){
            this.hideDialog = true;
        }
        */
    }


    window.customElements.define(VerwijderIngredient.is, VerwijderIngredient);
  </script>
</dom-module>
